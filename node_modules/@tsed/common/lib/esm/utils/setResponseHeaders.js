function mergeHeaders(specHeaders, headers) {
    return Object.entries(specHeaders).reduce((headers, [key, item]) => {
        key = key.toLowerCase();
        return {
            ...headers,
            [key]: headers[key] === undefined ? String(item.example) : headers[key]
        };
    }, headers);
}
/**
 * @ignore
 */
export function setResponseHeaders(ctx) {
    const { response, endpoint } = ctx;
    const { operation } = endpoint;
    if (response.isDone()) {
        return;
    }
    if (!response.hasStatus()) {
        // apply status only if the isn't already modified
        response.status(operation.getStatus());
    }
    const statusCode = response.statusCode;
    const headers = operation.getHeadersOf(response.statusCode);
    const mergedHeaders = mergeHeaders(headers, response.getHeaders());
    response.setHeaders(mergedHeaders);
    if (operation.isRedirection(statusCode)) {
        response.redirect(statusCode, String(mergedHeaders["location"]));
    }
}
//# sourceMappingURL=setResponseHeaders.js.map