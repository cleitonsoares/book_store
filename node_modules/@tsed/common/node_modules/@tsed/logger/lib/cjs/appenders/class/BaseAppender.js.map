{"version":3,"file":"BaseAppender.js","sourceRoot":"","sources":["../../../../src/appenders/class/BaseAppender.ts"],"names":[],"mappings":";;;;;AACA,yDAAoD;AAkBpD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAiCG;AACH,MAAsB,YAAY;IAOhC,YAA4B,MAA6B;QAA7B,WAAM,GAAN,MAAM,CAAuB;QANzD,uCAAa;QAEN,oBAAe,GAAoB,EAAC,IAAI,EAAE,EAAE,EAAC,CAAC;QAKnD,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;QAEvB,IAAI,IAAI,CAAC,OAAO,CAAC,EAAE;YACjB,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC;SACjB;IACH,CAAC;IAED,SAAS,CAAC,MAAoC;QAC5C,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;QAEnC,+BAAA,IAAI,wBAAW,iBAAO,CAAC,GAAG,CAAC,IAAI,CAAC,eAAe,CAAC,aAAa,IAAI,SAAS,EAAE,IAAI,CAAC,MAAM,CAAC,MAAA,CAAC;QAEzF,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE;YACtB,+BAAA,IAAI,wBAAW,iBAAO,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,MAAA,CAAC;SACzE;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAED;;;OAGG;IACH,MAAM,CAAC,GAAG,IAAW;QACnB,OAAO,+BAAA,IAAI,4BAAQ,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC,CAAC;IACzC,CAAC;CAGF;AAnCD,oCAmCC","sourcesContent":["import {LogEvent} from \"../../core/LogEvent\";\nimport {Layouts} from \"../../layouts/class/Layouts\";\nimport {AppenderConfiguration, PartialAppenderConfiguration} from \"../interfaces/AppenderConfiguration\";\n\nexport interface AppenderOptions {\n  name: string;\n  defaultLayout?: string;\n}\n\nexport interface IBaseAppender {\n  write(loggingEvent: LogEvent): any;\n\n  build?(): any;\n\n  reopen?(): any;\n\n  shutdown?(): Promise<any> | any | void;\n}\n\n/**\n * ## BaseAppender\n *\n * `@tsed/logger` can load appenders from outside the core appenders. The type config value is used as a require path if no matching appender can be found. For example, the following configuration will create an appender with decorators:\n *\n * ```typescript\n * // consoleAppender.ts\n * import {Appender, BaseAppender, LogEvent} from \"@tsed/logger\";\n * const consoleLog = console.log.bind(console);\n *\n * @ Appender({name: \"console2\"})\n * export class ConsoleAppender extends BaseAppender {\n *   write(loggingEvent: LogEvent) {\n *       consoleLog(this.layout(loggingEvent, this.config.timezoneOffset));\n *   }\n * }\n * ```\n *\n * This appender can be use like this:\n *\n * ```typescript\n * import {Logger} from \"@tsed/logger\";\n * import \"./consoleAppender.ts\"\n *\n * const logger = new Logger(\"loggerName\");\n *\n * logger.appenders\n *   .set(\"console-log\", {\n *       type: \"console2\", level: [\"debug\", \"info\", \"trace\"]\n *   });\n * ```\n *\n *\n */\nexport abstract class BaseAppender implements IBaseAppender {\n  #layout: any;\n\n  public appenderOptions: AppenderOptions = {name: \"\"};\n\n  [key: string]: any;\n\n  constructor(public readonly config: AppenderConfiguration) {\n    this.configure(config);\n\n    if (this[\"build\"]) {\n      this[\"build\"]();\n    }\n  }\n\n  configure(config: PartialAppenderConfiguration) {\n    Object.assign(this.config, config);\n\n    this.#layout = Layouts.get(this.appenderOptions.defaultLayout || \"colored\", this.config);\n\n    if (this.config.layout) {\n      this.#layout = Layouts.get(this.config.layout.type, this.config.layout);\n    }\n    return this;\n  }\n\n  /**\n   *\n   * @param args\n   */\n  layout(...args: any[]): string {\n    return this.#layout.transform(...args);\n  }\n\n  abstract write(loggingEvent: LogEvent): any;\n}\n"]}