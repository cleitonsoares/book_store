"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.importComponents = exports.mapConfiguration = void 0;
const core_1 = require("@tsed/core");
const importFiles_1 = require("./importFiles");
/**
 * @deprecated
 */
async function resolveSymbols(item, excludes, disableComponentsScan = false) {
    if ((0, core_1.isClass)(item)) {
        return [item];
    }
    /* istanbul ignore else */
    if (!disableComponentsScan) {
        return (0, importFiles_1.importFiles)(item, excludes);
    }
    /* istanbul ignore next */
    return [];
}
/**
 * @deprecated
 */
function mapConfiguration(config) {
    if ((0, core_1.isArray)(config)) {
        return config.map((value) => {
            return {
                values: [].concat(value)
            };
        });
    }
    return Object.keys(config).reduce((list, key) => {
        list.push({
            endpoint: key,
            values: [].concat(config[key])
        });
        return list;
    }, []);
}
exports.mapConfiguration = mapConfiguration;
/**
 * @deprecated
 */
async function importComponents(config, excludes, disableComponentsScan = false) {
    if (!config) {
        return [];
    }
    config = mapConfiguration(config);
    const promises = [];
    for (const option of config) {
        promises.push(...option.values.map(async (value) => {
            const symbols = await resolveSymbols(value, excludes, disableComponentsScan);
            return symbols.filter(core_1.isClass).map((symbol) => ({ token: symbol, route: option.endpoint }));
        }));
    }
    const result = await Promise.all(promises);
    return result.flat();
}
exports.importComponents = importComponents;
//# sourceMappingURL=importComponents.js.map