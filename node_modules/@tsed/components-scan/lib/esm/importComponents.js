import { isArray, isClass } from "@tsed/core";
import { importFiles } from "./importFiles.js";
/**
 * @deprecated
 */
async function resolveSymbols(item, excludes, disableComponentsScan = false) {
    if (isClass(item)) {
        return [item];
    }
    /* istanbul ignore else */
    if (!disableComponentsScan) {
        return importFiles(item, excludes);
    }
    /* istanbul ignore next */
    return [];
}
/**
 * @deprecated
 */
export function mapConfiguration(config) {
    if (isArray(config)) {
        return config.map((value) => {
            return {
                values: [].concat(value)
            };
        });
    }
    return Object.keys(config).reduce((list, key) => {
        list.push({
            endpoint: key,
            values: [].concat(config[key])
        });
        return list;
    }, []);
}
/**
 * @deprecated
 */
export async function importComponents(config, excludes, disableComponentsScan = false) {
    if (!config) {
        return [];
    }
    config = mapConfiguration(config);
    const promises = [];
    for (const option of config) {
        promises.push(...option.values.map(async (value) => {
            const symbols = await resolveSymbols(value, excludes, disableComponentsScan);
            return symbols.filter(isClass).map((symbol) => ({ token: symbol, route: option.endpoint }));
        }));
    }
    const result = await Promise.all(promises);
    return result.flat();
}
//# sourceMappingURL=importComponents.js.map