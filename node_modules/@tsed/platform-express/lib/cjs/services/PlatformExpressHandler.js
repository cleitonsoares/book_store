"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.PlatformExpressHandler = void 0;
const common_1 = require("@tsed/common");
/**
 * @platform
 * @express
 */
class PlatformExpressHandler extends common_1.PlatformHandler {
    createRawHandler(metadata) {
        if (metadata.type === common_1.HandlerType.ERR_MIDDLEWARE) {
            const handler = this.compileHandler(metadata);
            return async (err, req, res, next) => handler({
                err,
                next,
                $ctx: req.$ctx
            });
        }
        return super.createRawHandler(metadata);
    }
    async onCtxRequest(requestOptions) {
        try {
            return await super.onCtxRequest(requestOptions);
        }
        catch (er) {
            return this.onError(er, requestOptions);
        }
    }
}
exports.PlatformExpressHandler = PlatformExpressHandler;
//# sourceMappingURL=PlatformExpressHandler.js.map