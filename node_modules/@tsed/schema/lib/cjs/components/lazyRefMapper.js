"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.lazyRefMapper = void 0;
const JsonSchemaMapperContainer_1 = require("../registries/JsonSchemaMapperContainer");
const generics_1 = require("../utils/generics");
const ref_1 = require("../utils/ref");
function lazyRefMapper(input, options) {
    var _a;
    const name = input.name;
    if ((_a = options.$refs) === null || _a === void 0 ? void 0 : _a.find((t) => t === input.target)) {
        return (0, ref_1.createRef)(name, input.schema, options);
    }
    options.$refs = [...(options.$refs || []), input.target];
    const schema = input.toJSON((0, generics_1.mapGenericsOptions)(options));
    return (0, ref_1.toRef)(input.schema, schema, options);
}
exports.lazyRefMapper = lazyRefMapper;
(0, JsonSchemaMapperContainer_1.registerJsonSchemaMapper)("lazyRef", lazyRefMapper);
//# sourceMappingURL=lazyRefMapper.js.map