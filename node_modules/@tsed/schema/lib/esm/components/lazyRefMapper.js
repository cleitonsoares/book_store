import { registerJsonSchemaMapper } from "../registries/JsonSchemaMapperContainer.js";
import { mapGenericsOptions } from "../utils/generics.js";
import { createRef, toRef } from "../utils/ref.js";
export function lazyRefMapper(input, options) {
    var _a;
    const name = input.name;
    if ((_a = options.$refs) === null || _a === void 0 ? void 0 : _a.find((t) => t === input.target)) {
        return createRef(name, input.schema, options);
    }
    options.$refs = [...(options.$refs || []), input.target];
    const schema = input.toJSON(mapGenericsOptions(options));
    return toRef(input.schema, schema, options);
}
registerJsonSchemaMapper("lazyRef", lazyRefMapper);
//# sourceMappingURL=lazyRefMapper.js.map